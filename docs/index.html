<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT-2 Chatbot | Client-Side AI</title>
    <meta name="description" content="GPT-2 chatbot running entirely in your browser using Transformers.js">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/mobile.css">
</head>
<body>
    <!-- Sidebar for conversation list -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2 data-i18n="conversations">–†–æ–∑–º–æ–≤–∏</h2>
            <button id="sidebarToggle" class="btn-icon" aria-label="Toggle sidebar">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M3 5h14M3 10h14M3 15h14" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
        </div>

        <div class="conversation-list" id="conversationList">
            <!-- Conversations will be dynamically inserted here -->
        </div>

        <div class="sidebar-footer">
            <button id="newChatBtn" class="btn btn-primary w-full">
                <span data-i18n="new_chat">–ù–æ–≤–∏–π —á–∞—Ç</span>
            </button>
        </div>
    </aside>

    <!-- Main content area -->
    <main class="main-content">
        <!-- Header with controls -->
        <header class="chat-header">
            <div class="header-left">
                <button id="mobileSidebarToggle" class="btn-icon mobile-only" aria-label="Open sidebar">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M3 12h18M3 6h18M3 18h18" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                <h1 data-i18n="app_title">GPT-2 –ß–∞—Ç-–±–æ—Ç</h1>
            </div>

            <div class="header-actions">
                <!-- Language toggle -->
                <button id="languageToggle" class="btn btn-icon" title="Switch language">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M10 2C5.58 2 2 5.58 2 10s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.25 14.15C13.24 17.27 11.68 18 10 18s-3.24-.73-4.25-1.85c1.14-1.16 2.68-1.88 4.25-1.88s3.11.72 4.25 1.88zM10 12c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"/>
                    </svg>
                    <span id="currentLang" class="lang-text">EN</span>
                </button>

                <!-- Upload conversation -->
                <button id="uploadBtn" class="btn btn-secondary" data-i18n-title="upload_conversation">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 0L4 4h2.5v6h3V4H12L8 0z"/>
                        <path d="M0 14h16v2H0z"/>
                    </svg>
                    <span data-i18n="upload">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</span>
                </button>
                <input type="file" id="fileInput" accept=".json" style="display: none">

                <!-- Status indicator -->
                <div class="status-indicator" id="statusIndicator">
                    <span class="status-dot"></span>
                    <span class="status-text" data-i18n="status_loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
                </div>
            </div>
        </header>

        <!-- Progress bar for model loading -->
        <div id="loadingProgress" class="loading-progress" style="display: none;">
            <div class="progress-bar">
                <div class="loading-bar" id="progressFill"></div>
            </div>
            <div class="progress-text" id="loadingStatus">Loading model...</div>
        </div>

        <!-- Chat messages area -->
        <div class="chat-container">
            <div class="chat-messages" id="messagesContainer">
                <div class="welcome-message">
                    <h2 data-i18n="welcome_title">–í—ñ—Ç–∞—î–º–æ –≤ GPT-2 —á–∞—Ç-–±–æ—Ç—ñ!</h2>
                    <p data-i18n="welcome_message">–ü–æ—á–Ω—ñ—Ç—å —Ä–æ–∑–º–æ–≤—É –Ω–∏–∂—á–µ. –ú–æ–¥–µ–ª—å –ø—Ä–∞—Ü—é—î –ø–æ–≤–Ω—ñ—Å—Ç—é —É –≤–∞—à–æ–º—É –±—Ä–∞—É–∑–µ—Ä—ñ.</p>
                    <p class="welcome-note" data-i18n="welcome_note">
                        –ü–µ—Ä—à–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ –º–æ–∂–µ –∑–∞–π–Ω—è—Ç–∏ 10-30 —Å–µ–∫—É–Ω–¥. –ù–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø—É—Å–∫–∏ –±—É–¥—É—Ç—å –º–∏—Ç—Ç—î–≤–∏–º–∏.
                    </p>
                </div>
            </div>

            <!-- Chat input area -->
            <div class="chat-input-container">
                <form id="chatForm">
                    <textarea
                        id="messageInput"
                        data-i18n-placeholder="message_placeholder"
                        placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..."
                        rows="3"
                        maxlength="2000"
                    ></textarea>
                    <button type="submit" class="btn btn-primary" id="sendBtn">
                        <span data-i18n="send">–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</span>
                    </button>
                </form>
                <div class="input-info">
                    <span id="charCount">0 —Å–∏–º–≤–æ–ª—ñ–≤</span>
                </div>
            </div>
        </div>

        <!-- Settings panel -->
        <div class="settings-panel">
            <div class="settings-header">
                <h3 data-i18n="settings">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ</h3>
                <div class="settings-actions">
                    <button id="downloadJsonBtn" class="btn btn-sm" data-i18n-title="download_json">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 12L4 8h2.5V2h3v6H12L8 12z"/>
                            <path d="M0 14h16v2H0z"/>
                        </svg>
                        JSON
                    </button>
                    <button id="downloadTxtBtn" class="btn btn-sm" data-i18n-title="download_txt">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 12L4 8h2.5V2h3v6H12L8 12z"/>
                            <path d="M0 14h16v2H0z"/>
                        </svg>
                        TXT
                    </button>
                </div>
            </div>

            <div class="setting-item">
                <label for="modelSelector">
                    <span data-i18n="model">–ú–æ–¥–µ–ª—å</span>
                </label>
                <select id="modelSelector" class="model-select">
                    <optgroup label="üèÜ Best for Chat (Recommended)">
                        <option value="onnx-community/Qwen2.5-1.5B" selected>‚≠ê Qwen2.5 1.5B (~900MB) - Best quality</option>
                        <option value="onnx-community/Phi-3.5-mini-instruct-onnx-web">Phi-3.5 Mini (3.8B, ~2.3GB) - Highest quality (WebGPU)</option>
                        <option value="onnx-community/Llama-3.2-1B-Instruct-ONNX">Llama 3.2 1B (~650MB) - Latest Meta tech</option>
                        <option value="onnx-community/TinyLlama-1.1B-Chat-v1.0-ONNX">TinyLlama 1.1B (~650MB) - Chat optimized</option>
                    </optgroup>
                    <optgroup label="‚ö° Fast & Efficient">
                        <option value="onnx-community/Qwen2.5-0.5B-Instruct">Qwen2.5 0.5B (~300MB) - Very fast</option>
                        <option value="onnx-community/gemma-3-270m-it-ONNX">Gemma 3 270M (~150MB) - Google's latest</option>
                        <option value="onnx-community/MobileLLM-125M">MobileLLM 125M (~70MB) - Ultra lightweight</option>
                        <option value="Xenova/distilgpt2">DistilGPT-2 82M (~150MB) - Fastest classic</option>
                    </optgroup>
                    <optgroup label="üî¨ Advanced Models">
                        <option value="onnx-community/Llama-3.2-3B-Instruct-ONNX">Llama 3.2 3B (~1.8GB) - High quality</option>
                        <option value="onnx-community/gemma-3-1b-it-ONNX">Gemma 3 1B (~600MB) - Google multimodal</option>
                        <option value="onnx-community/MobileLLM-1B">MobileLLM 1B (~600MB) - Efficient 1B model</option>
                        <option value="Xenova/stablelm-2-zephyr-1_6b">StableLM 1.6B (~1GB) - Stability AI</option>
                    </optgroup>
                    <optgroup label="üìö GPT-2 Family (Classic)">
                        <option value="Xenova/gpt2">GPT-2 124M (~250MB)</option>
                        <option value="Xenova/gpt2-medium">GPT-2 Medium 355M (~700MB)</option>
                    </optgroup>
                    <optgroup label="üíª Coding Specialists">
                        <option value="onnx-community/Qwen2.5-Coder-0.5B-Instruct">Qwen2.5 Coder 0.5B (~300MB) - Code generation</option>
                    </optgroup>
                </select>
                <div class="model-info" style="font-size: 11px; color: var(--secondary-color); margin-top: 5px;">
                    Note: Larger models provide better quality but require more RAM and load time.
                </div>
            </div>

            <div class="setting-item">
                <label for="temperature">
                    Temperature: <span id="temperatureValue">0.7</span>
                </label>
                <input type="range" id="temperature" min="0.1" max="1.0" step="0.1" value="0.7">
            </div>

            <div class="setting-item">
                <label for="maxLength">
                    Max Length: <span id="maxLengthValue">100</span>
                </label>
                <input type="range" id="maxLength" min="20" max="200" step="10" value="100">
            </div>

            <div class="setting-item">
                <label for="topK">
                    Top K: <span id="topKValue">50</span>
                </label>
                <input type="range" id="topK" min="1" max="100" step="1" value="50">
            </div>

            <div class="setting-item">
                <label for="topP">
                    Top P: <span id="topPValue">0.9</span>
                </label>
                <input type="range" id="topP" min="0.1" max="1.0" step="0.05" value="0.9">
            </div>

            <div class="setting-item">
                <label for="repetitionPenalty">
                    Repetition Penalty: <span id="repetitionPenaltyValue">1.2</span>
                </label>
                <input type="range" id="repetitionPenalty" min="1.0" max="2.0" step="0.1" value="1.2">
            </div>
        </div>
    </main>

    <!-- Load app as ES6 module -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
